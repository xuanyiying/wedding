# ========================================
# 腾讯云服务器专用环境配置文件
# Wedding Client Tencent Cloud Environment
# ========================================

# ========================================
# 服务器基础配置
# ========================================
SERVER_IP=localhost
INTERNAL_IP=localhost


# 部署目录配置
DEPLOY_DIR=/root/wedding
REMOTE_DIR=/root/wedding
BACKUP_DIR=/root/wedding/backups
LOG_DIR=/root/wedding/logs
DATA_DIR=/root/wedding/data
UPLOADS_DIR=/root/wedding/uploads

# ========================================
# 服务端口配置 (腾讯云优化)
# ========================================
WEB_PORT=8080
API_PORT=3000
MYSQL_PORT=3306
REDIS_PORT=6379
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001

# ========================================
# 项目基础信息
# ========================================
PROJECT_NAME=wedding
ENVIRONMENT=production
NODE_ENV=production
LOG_LEVEL=info

# ========================================
# 数据库配置 (MySQL)
# ========================================
MYSQL_ROOT_PASSWORD=W3dd1ng_R00t_2024_Pr0d_S3cur3!
MYSQL_DATABASE=wedding_club
MYSQL_USER=wedding_user
MYSQL_PASSWORD=W3dd1ng_Us3r_2024_Pr0d_S3cur3!

# 数据库连接配置 (使用容器内部名称)
DB_HOST=mysql
DB_PORT=3306
DB_NAME=wedding_club
DB_USERNAME=wedding_user
DB_PASSWORD=W3dd1ng_Us3r_2024_Pr0d_S3cur3!
DATABASE_URL=mysql://wedding_user:W3dd1ng_Us3r_2024_Pr0d_S3cur3!@mysql:3306/wedding_club

# ========================================
# Redis缓存配置
# ========================================
REDIS_PASSWORD=R3d1s_W3dd1ng_2024_Pr0d_S3cur3!
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_URL=redis://:R3d1s_W3dd1ng_2024_Pr0d_S3cur3!@redis:6379

# ========================================

# ========================================
# OSS存储配置 (统一配置)
# ========================================
# OSS服务类型
OSS_TYPE=minio

# OSS服务端点
OSS_ENDPOINT=http://minio:9000

# OSS区域设置
OSS_REGION=us-east-1

# OSS访问密钥配置
OSS_ACCESS_KEY_ID=weddingadmin
OSS_ACCESS_KEY_SECRET=M1n10_W3dd1ng_2024_Pr0d_S3cur3!

# 兼容配置
OSS_ACCESS_KEY=weddingadmin
OSS_SECRET_KEY=M1n10_W3dd1ng_2024_Pr0d_S3cur3!

# OSS存储桶
OSS_BUCKET=wedding-media-prod

# 安全连接配置
OSS_SECURE=false

# CDN配置
OSS_CDN_BASE_URL=http://localhost:9000
CDN_BASE_URL=http://localhost:9000

# MinIO特定配置
MINIO_ENDPOINT=minio
MINIO_PORT=9000
MINIO_ACCESS_KEY=weddingadmin
MINIO_SECRET_KEY=M1n10_W3dd1ng_2024_Pr0d_S3cur3!
MINIO_BUCKET=wedding-media-prod
MINIO_PUBLIC_ENDPOINT=http://localhost:9000



# ========================================
# JWT认证配置
# ========================================
JWT_SECRET=JWT_W3dd1ng_S3cr3t_2024_Pr0duct10n_K3y_V3ry_S3cur3_L0ng_Str1ng!
JWT_REFRESH_SECRET=JWT_R3fr3sh_W3dd1ng_S3cr3t_2024_Pr0duct10n_K3y_V3ry_S3cur3!
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# ========================================
# API服务配置 (腾讯云优化)
# ========================================
API_HOST=0.0.0.0
API_PORT=3000
API_TIMEOUT=30000
API_RATE_LIMIT=100
CORS_ORIGIN=http://localhost

# ========================================
# 前端Web配置 (腾讯云无域名)
# ========================================
VITE_API_URL=http://localhost/api
VITE_UPLOAD_URL=http://localhost/upload
VITE_MINIO_URL=http://localhost:9000
VITE_APP_TITLE="Wedding Client"
VITE_APP_VERSION=1.0.0

# ========================================
# Docker镜像配置 (使用本地镜像)
# ========================================
WEB_IMAGE=wedding-web:latest
API_IMAGE=wedding-api:latest
MYSQL_IMAGE=mysql:8.0
REDIS_IMAGE=redis:7-alpine
MINIO_IMAGE=minio/minio:latest
NGINX_IMAGE=nginx:alpine

# 禁用镜像拉取
USE_REGISTRY=false
PULL_IMAGES=false

# ========================================
# 监控和健康检查配置 (腾讯云优化)
# ========================================
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=60

# ========================================
# 日志配置 (减少日志输出)
# ========================================
LOG_LEVEL=warn
LOG_FORMAT=simple
MAX_LOG_FILES=5
MAX_LOG_SIZE=50M
LOG_RETENTION_DAYS=7

# ========================================
# 性能配置 (腾讯云资源优化)
# ========================================
# Node.js性能配置 (减少内存使用)
NODE_OPTIONS=--max-old-space-size=256
UV_THREADPOOL_SIZE=2

# 数据库连接池配置 (减少连接数)
DB_CONNECTION_LIMIT=10
DB_ACQUIRE_TIMEOUT=30000
DB_TIMEOUT=30000

# Redis连接配置
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1000
REDIS_CONNECTION_TIMEOUT=5000

# ========================================
# 安全配置 (腾讯云无域名)
# ========================================
# CORS配置 (支持IP访问)
CORS_ORIGIN=http://localhost
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With

# 安全头配置
SECURITY_HEADERS=true
HSTS_MAX_AGE=0
CSP_POLICY="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: http://localhost:9000;"

# 速率限制配置 (宽松设置)
RATE_LIMIT_WINDOW=15
RATE_LIMIT_MAX_REQUESTS=50
RATE_LIMIT_SKIP_SUCCESSFUL=false

# ========================================
# 备份配置 (简化)
# ========================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"
BACKUP_RETENTION_DAYS=3
BACKUP_COMPRESSION=true

# ========================================
# SSL/TLS配置 (禁用HTTPS)
# ========================================
SSL_ENABLED=false

# ========================================
# 第三方服务配置
# ========================================
# 邮件服务配置 (腾讯企业邮箱示例)
SMTP_HOST=smtp.exmail.qq.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=admin@yourcompany.com
SMTP_PASS=your_smtp_password_here
SMTP_FROM=Wedding Club <admin@yourcompany.com>

# ========================================
# 开发和调试配置
# ========================================
DEBUG=false
VERBOSE_LOGGING=false
ENABLE_PROFILING=false
ENABLE_METRICS=false

# ========================================
# 特性开关
# ========================================
FEATURE_UPLOAD_ENABLED=true
FEATURE_ADMIN_PANEL=true
FEATURE_USER_REGISTRATION=true
FEATURE_EMAIL_VERIFICATION=false
FEATURE_SMS_VERIFICATION=false

# ========================================
# 缓存配置
# ========================================
CACHE_TTL=1800
CACHE_MAX_SIZE=500
CACHE_ENABLED=true

# ========================================
# 文件上传配置
# ========================================
# 基础上传配置
UPLOAD_MAX_FILE_SIZE=104857600
UPLOAD_ALLOWED_IMAGE_TYPES=image/jpeg,image/png,image/gif,image/webp
UPLOAD_ALLOWED_VIDEO_TYPES=video/mp4,video/avi,video/mov,video/wmv
UPLOAD_ALLOWED_AUDIO_TYPES=audio/mp3,audio/wav,audio/aac

# 超时配置
UPLOAD_TIMEOUT=300000
UPLOAD_TIMEOUT_CUSTOMIZABLE=true
UPLOAD_MIN_TIMEOUT=10000
UPLOAD_MAX_TIMEOUT=1800000
UPLOAD_PRESIGNED_TIMEOUT=30000
UPLOAD_CONFIRM_TIMEOUT=60000
UPLOAD_CHUNK_TIMEOUT=120000
UPLOAD_VALIDATION_TIMEOUT=30000
UPLOAD_OSS_TIMEOUT=60000

# 重试配置
UPLOAD_RETRY_ATTEMPTS=3
UPLOAD_RETRY_DELAY=1000
UPLOAD_RETRY_BACKOFF=exponential
UPLOAD_RETRY_MAX_DELAY=30000
UPLOAD_RETRY_CUSTOMIZABLE=true
UPLOAD_MIN_RETRY_ATTEMPTS=0
UPLOAD_MAX_RETRY_ATTEMPTS=10
UPLOAD_MIN_RETRY_DELAY=100
UPLOAD_ENABLE_CIRCUIT_BREAKER=true
UPLOAD_CIRCUIT_BREAKER_THRESHOLD=5
UPLOAD_CIRCUIT_BREAKER_TIMEOUT=60000

# 上传模式配置
UPLOAD_ENABLE_DIRECT=true
UPLOAD_FORCE_SERVER_UPLOAD=false
UPLOAD_CHUNK_SIZE=5242880
UPLOAD_ENABLE_CHUNK_UPLOAD=true
UPLOAD_MAX_CONCURRENT_CHUNKS=5
UPLOAD_AUTO_MODE_THRESHOLD=10485760
UPLOAD_ENABLE_RESUME=true
UPLOAD_RESUME_CHUNK_SIZE=2097152
UPLOAD_DIRECT_SIZE_LIMIT=104857600
UPLOAD_SERVER_SIZE_LIMIT=1073741824

# 安全配置
UPLOAD_ENABLE_VIRUS_SCAN=true
UPLOAD_MAX_CONCURRENT_UPLOADS=20
UPLOAD_RATE_LIMIT_PER_USER=100

# 存储配置
UPLOAD_TEMP_DIR=uploads/temp
UPLOAD_CLEANUP_INTERVAL=3600000
UPLOAD_MAX_TEMP_FILE_AGE=86400000
UPLOAD_PATH=/app/uploads
UPLOAD_TEMP_PATH=/tmp/uploads

# ========================================
# 会话配置
# ========================================
SESSION_SECRET=S3ss10n_W3dd1ng_S3cr3t_2024_Pr0d_V3ry_S3cur3!
SESSION_MAX_AGE=86400000
SESSION_SECURE=false
SESSION_HTTP_ONLY=true

# ========================================
# 时区和本地化配置
# ========================================
TZ=Asia/Shanghai
LANG=zh_CN.UTF-8
LC_ALL=zh_CN.UTF-8
DEFAULT_LOCALE=zh-CN

# ========================================
# 资源限制配置 (腾讯云优化)
# ========================================
# MySQL资源限制 (减少内存使用)
MYSQL_MAX_CONNECTIONS=100
MYSQL_INNODB_BUFFER_POOL_SIZE=128M

# Redis资源限制
REDIS_MAX_MEMORY=64mb
REDIS_MAX_MEMORY_POLICY=allkeys-lru

# API资源限制
API_MAX_REQUEST_SIZE=50mb
API_MAX_CONCURRENT_REQUESTS=50

# ========================================
# 腾讯云特定配置
# ========================================
CLOUD_PROVIDER=tencent
DEPLOYMENT_ENV=tencent-cloud
DEPLOYMENT_DATE=$(date '+%Y-%m-%d %H:%M:%S')
VERSION=1.0.0

# 网络配置
NETWORK_MODE=bridge
DOCKER_NETWORK_NAME=wedding-net

# 容器重启策略
RESTART_POLICY=unless-stopped

# 容器健康检查
HEALTHCHECK_ENABLED=true
